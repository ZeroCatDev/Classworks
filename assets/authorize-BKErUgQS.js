import{ao as V,ap as g,Z as _,s as c,k,o as u,j as l,w as e,c as a,l as y,q as C,v as i,A as d,z as h,ag as x,D as p,i as T,M as B,x as N,y as S,a2 as f}from"./index-BkTj-oy6.js";import{V as w,a as R}from"./VRow-BtMNlvVB.js";import{V as j}from"./VContainer-qcDXnPgm.js";const M={__name:"authorize",setup(q){const m=V(),n=g(),s=f("processing"),r=f("正在验证授权信息...");_(async()=>{try{const t=m.query.token;if(!t){s.value="error",r.value="未获取到授权令牌";return}c("server.kvToken",t);const o=k("device.uuid");o&&o!=="00000000-0000-4000-8000-000000000000"?(c("device.uuid","00000000-0000-4000-8000-000000000000"),r.value="授权成功！已完成数据迁移。"):r.value="授权成功！",s.value="success",n.push("/")}catch(t){console.error("授权处理失败:",t),s.value="error",r.value=`授权失败: ${t.message}`}});const v=()=>{n.push("/")};return(t,o)=>(u(),l(j,{class:"fill-height",fluid:""},{default:e(()=>[a(w,{align:"center",justify:"center"},{default:e(()=>[a(R,{cols:"12",md:"6",sm:"8"},{default:e(()=>[a(y,null,{default:e(()=>[a(C,{class:"text-h5"},{default:e(()=>[i(d(s.value==="processing"?"正在处理授权...":s.value==="success"?"授权成功":"授权失败"),1)]),_:1}),a(h,null,{default:e(()=>[s.value==="processing"?(u(),l(x,{key:0,class:"mb-4",color:"primary",indeterminate:""})):p("",!0),T("p",null,d(r.value),1)]),_:1}),s.value!=="processing"?(u(),l(B,{key:0},{default:e(()=>[a(N),a(S,{color:"primary",onClick:v},{default:e(()=>[...o[0]||(o[0]=[i("返回首页",-1)])]),_:1})]),_:1})):p("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}};export{M as default};
