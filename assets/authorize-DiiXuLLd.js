import{a5 as V,a6 as g,a7 as c,a8 as _,s as i,k,j as u,o as l,w as e,d as s,l as y,B as d,q as C,t as f,C as m,z as h,i as x,a9 as B,W as T,x as N,y as S}from"./index-Byrx_Q-8.js";import{a as w,V as R}from"./VRow-CPxldTZC.js";import{V as j}from"./VContainer-DnLeA4GE.js";const D={__name:"authorize",setup(q){const p=V(),n=g(),a=c("processing"),r=c("正在验证授权信息...");_(async()=>{try{const t=p.query.token;if(!t){a.value="error",r.value="未获取到授权令牌";return}i("server.kvToken",t);const o=k("device.uuid");o&&o!=="00000000-0000-4000-8000-000000000000"?(i("device.uuid","00000000-0000-4000-8000-000000000000"),r.value="授权成功！已完成数据迁移。"):r.value="授权成功！",a.value="success",n.push("/")}catch(t){console.error("授权处理失败:",t),a.value="error",r.value=`授权失败: ${t.message}`}});const v=()=>{n.push("/")};return(t,o)=>(l(),u(j,{class:"fill-height",fluid:""},{default:e(()=>[s(w,{align:"center",justify:"center"},{default:e(()=>[s(R,{cols:"12",sm:"8",md:"6"},{default:e(()=>[s(y,null,{default:e(()=>[s(C,{class:"text-h5"},{default:e(()=>[f(m(a.value==="processing"?"正在处理授权...":a.value==="success"?"授权成功":"授权失败"),1)]),_:1}),s(h,null,{default:e(()=>[a.value==="processing"?(l(),u(B,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):d("",!0),x("p",null,m(r.value),1)]),_:1}),a.value!=="processing"?(l(),u(T,{key:0},{default:e(()=>[s(N),s(S,{color:"primary",onClick:v},{default:e(()=>[...o[0]||(o[0]=[f("返回首页",-1)])]),_:1})]),_:1})):d("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}};export{D as default};
